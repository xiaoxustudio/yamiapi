<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: data.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: data.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict'

// ******************************** 数据对象 ********************************

const Data = new class {
  // 游戏数据
  manifest
  actors
  skills
  triggers
  items
  equipments
  states
  events
  scripts
  easings
  teams
  autotiles
  variables
  attribute
  enumeration
  plugins
  commands
  config
  scenes = {}
  ui
  animations
  particles
  tilesets
  globalData

  // 文件名GUID正则表达式
  fileGuidRegExp = /[./]([0-9a-f]{16})\.\S+$/

  /**
   * 初始化数据管理器
   * @returns {Promise}
   */
  initialize() {
    // 侦听窗口关闭前事件
    Game.on('quit', () => {
      Data.saveGlobalData()
    })

    // 加载数据文件
    return Promise.all([
      // 优先加载属性和枚举用于编译事件
      this.loadFile('attribute'),
      this.loadFile('enumeration'),
      this.loadFile('localization'),
      this.loadObjects(),
      this.loadScripts(),
      this.loadFile('easings'),
      this.loadFile('teams'),
      this.loadFile('autotiles'),
      this.loadFile('variables'),
      this.loadFile('plugins'),
      this.loadFile('commands'),
      this.loadGlobalData()
    ]).then(() => {
      this.createAutotileMap()
      this.createEasingMap()
    })
  }

  /**
   * 加载文件的元数据清单
   * @returns {Promise}
   */
  loadMeta() {
    const path = 'Data/manifest.json'
    return File.get({
      path: path,
      type: 'json',
      sync: true,
    }).then(
      data => {
        if (!data) {
          throw new SyntaxError(path)
        }
        return this.manifest = data
      }
    ).then(manifest => {
      // 创建GUID->元数据映射表
      const guidMap = {}
      Object.defineProperty(manifest, 'guidMap', {value: guidMap})
      for (const [key, group] of Object.entries(manifest)) {
        switch (key) {
          case 'scenes':
          case 'images':
          case 'audio':
          case 'videos':
          case 'fonts':
          case 'script':
          case 'others':
            // 处理异步资产文件的元数据
            for (const meta of group) {
              meta.guid = this.parseGUID(meta)
              guidMap[meta.guid] = meta
            }
            break
          default:
            if (!manifest.deployed) {
              // 处理同步资产文件的元数据
              for (const meta of group) {
                meta.guid = this.parseGUID(meta)
              }
            }
            break
        }
      }
    })
  }

  /** 加载各种对象数据文件 */
  async loadObjects() {
    const {manifest} = this
    const idDescriptor = {value: ''}
    const pathDescriptor = {value: ''}
    const filenameDescriptor = {value: ''}
    const idAndPathDescriptors = {
      id: idDescriptor,
      path: pathDescriptor,
    }
    if (manifest.deployed) {
      // 加载已打包的数据
      for (const key of [
        'actors',
        'skills',
        'triggers',
        'items',
        'equipments',
        'states',
        'events',
        'ui',
        'animations',
        'particles',
        'tilesets',
      ]) {
        const group = this[key] = manifest[key]
        for (const [guid, data] of Object.entries(group)) {
          idDescriptor.value = guid
          pathDescriptor.value = `File.${guid}`
          Object.defineProperties(data, idAndPathDescriptors)
        }
      }
    } else {
      // 加载未打包的数据
      const fileDescriptor = {
        path: '',
        type: 'json',
        sync: true,
      }
      const table = [
        ['actors',     {}, null],
        ['skills',     {}, null],
        ['triggers',   {}, null],
        ['items',      {}, null],
        ['equipments', {}, null],
        ['states',     {}, null],
        ['events',     {}, null],
        ['ui',         {}, null],
        ['animations', {}, null],
        ['particles',  {}, null],
        ['tilesets',   {}, null],
      ]
      // 加载所有对象
      for (const row of table) {
        const key = row[0]
        const group = manifest[key]
        const length = group.length
        const promises = new Array(length)
        for (let i = 0; i &lt; length; i++) {
          fileDescriptor.path = group[i].path
          promises[i] = File.get(fileDescriptor)
        }
        row[2] = {group, promises}
      }
      // 等待加载完成并设置ID
      for (const row of table) {
        const key = row[0]
        const map = row[1]
        const {group, promises} = row[2]
        const length = group.length
        for (let i = 0; i &lt; length; i++) {
          const meta = group[i]
          try {
            const data = await promises[i]
            const id = meta.guid
            idDescriptor.value = id
            pathDescriptor.value = meta.path
            Object.defineProperties(data, idAndPathDescriptors)
            map[id] = data
          } catch (error) {
            console.log(`Failed to read file: ${error.message}`)
          }
        }
        this[key] = map
      }
      // 提取技能|物品|装备的文件名(用于排序)
      const guidAndExt = /\.[0-9a-f]{16}\.\S+$/
      for (const key of ['skills', 'items', 'equipments']) {
        const dataMap = this[key]
        for (const {guid, path} of manifest[key]) {
          const item = dataMap[guid]
          if (item !== undefined) {
            const index = path.lastIndexOf('/') + 1
            filenameDescriptor.value = path.slice(index).replace(guidAndExt, '')
            Object.defineProperty(item, 'filename', filenameDescriptor)
          }
        }
      }
    }
    this.precompile()
  }

  /** 预编译对象数据 */
  async precompile() {
    await this.attribute
    await this.enumeration
    Attribute.initialize()
    Enum.initialize()
    this.precompileActors()
    this.precompileSkills()
    this.precompileTriggers()
    this.precompileItems()
    this.precompileEquipments()
    this.precompileStates()
    this.precompileAnimations()
  }

  /** 预编译角色数据 */
  precompileActors() {
    for (const actor of Object.values(this.actors)) {
      actor.idleMotion = Enum.getValue(actor.idleMotion)
      actor.moveMotion = Enum.getValue(actor.moveMotion)
      this.compileEvents(actor, actor.path)
    }
  }

  /** 预编译技能数据 */
  precompileSkills() {
    for (const skill of Object.values(this.skills)) {
      this.compileEvents(skill, skill.path)
    }
  }

  /** 预编译触发器数据 */
  precompileTriggers() {
    for (const trigger of Object.values(this.triggers)) {
      trigger.motion = Enum.getValue(trigger.motion)
      this.compileEvents(trigger, trigger.path)
    }
  }

  /** 预编译物品数据 */
  precompileItems() {
    for (const item of Object.values(this.items)) {
      const {attributes} = item
      Attribute.loadEntries(
        item.attributes = {},
        attributes,
      )
      this.compileEvents(item, item.path)
    }
  }

  /** 预编译装备数据 */
  precompileEquipments() {
    for (const equipment of Object.values(this.equipments)) {
      this.compileEvents(equipment, equipment.path)
    }
  }

  /** 预编译状态数据 */
  precompileStates() {
    for (const state of Object.values(this.states)) {
      this.compileEvents(state, state.path)
    }
  }

  /** 预编译动画数据 */
  precompileAnimations() {
    // 计算动画当前动作的帧数
    const calculateLength = (layers, length) => {
      // 遍历所有图层的尾帧，获取最大长度
      for (const layer of layers) {
        const frames = layer.frames
        const frame = frames[frames.length - 1]
        if (frame !== undefined) {
          length = Math.max(length, frame.end)
        }
        if (layer.class === 'joint') {
          length = calculateLength(layer.children, length)
        }
      }
      return length
    }
    for (const animation of Object.values(this.animations)) {
      // 加载动作哈希表
      const motionMap = {}
      for (const motion of animation.motions) {
        // 设置动作名称
        motion.name = Enum.get(motion.id)?.value ?? motion.id
        // 添加当前动作的方向映射表
        motion.dirMap = Animation.dirMaps[motion.mode]
        // 计算当前动作的动画帧数和循环起始位置
        for (const dirCase of motion.dirCases) {
          const length = calculateLength(dirCase.layers, 0)
          const lastFrame = length - 1
          dirCase.loopStart = motion.loop ? Math.min(motion.loopStart, lastFrame) : 0
          dirCase.length = motion.skip &amp;&amp; dirCase.loopStart &lt; lastFrame ? lastFrame : length
        }
        // 添加动作到映射表中
        motionMap[motion.name] = motion
      }
      // 加载精灵哈希表
      const spriteMap = {}
      const imageMap = {}
      // 使用精灵数组生成精灵和图像哈希表
      for (const sprite of animation.sprites) {
        spriteMap[sprite.id] = sprite
        imageMap[sprite.id] = sprite.image
      }
      // 将动作列表替换为名称->动作映射表
      animation.motions = motionMap
      // 将精灵列表替换为精灵ID->精灵图数据映射表
      animation.sprites = spriteMap
      // 添加精灵ID->图像文件ID映射表
      animation.images = imageMap
    }
  }

  /** 加载脚本文件(动态导入模块) */
  async loadScripts() {
    this.remapScripts()
    const promises = []
    const scripts = this.scripts = {}
    // 动态导入所有脚本文件
    for (const meta of this.manifest.script) {
      const promise = import(`../${meta.path}`)
      promise.meta = meta
      promises.push(promise)
    }
    for (const promise of promises) {
      try {
        // 等待导入完成，获取构造函数
        const module = await promise
        const constructor = module.default
        if (typeof constructor === 'function') {
          const {meta} = promise
          constructor.guid = meta.guid
          scripts[meta.guid] = {
            constructor: constructor,
            parameters: meta.parameters ?? [],
          }
        }
      } catch (error) {
        console.error(error)
      }
    }
  }

  /** 重新映射脚本路径(TS->JS) */
  remapScripts() {
    if (this.manifest.deployed) return
    const {outDir} = this.config.script
    const tsExtname = /\.ts$/
    const tsOutDir = outDir.replace(/\/$/, '')
    for (const meta of this.manifest.script) {
      if (tsExtname.test(meta.path)) {
        meta.path = meta.path
        .replace('Assets', tsOutDir)
        .replace(tsExtname, '.js')
      }
    }
  }

  /**
   * 加载数据文件
   * @param {string} filename /data目录下的文件名
   * @returns {Promise&lt;object>}
   */
  loadFile(filename) {
    return this[filename] = File.get({
      path: `Data/${filename}.json`,
      type: 'json',
      sync: true,
    }).then(data => {
      return this[filename] = data
    })
  }

  /**
   * 加载场景数据
   * @param {string} id 场景文件ID
   * @returns {Promise&lt;Object>}
   */
  loadScene(id) {
    // 如果已经存在，返回解码后的场景
    if (this.scenes[id]) {
      return new Promise(resolve => {
        resolve(JSON.parse(this.scenes[id]))
      })
    }
    const meta = this.manifest.guidMap[id]
    if (!meta) {
      // 找不到场景文件的情况
      return new Promise((resolve, reject) => {
        reject(new URIError(`Scene #${id} is missing.`))
      })
    }
    // 加载场景JSON然后解码
    const path = meta.path
    return File.get({
      path: path,
      type: 'text',
      sync: true,
    }).then(code => {
      return JSON.parse(this.scenes[id] = code)
    })
  }

  /**
   * 从元数据中解析文件GUID
   * @param {Object} meta 文件的元数据
   * @returns {string} 文件GUID
   */
  parseGUID(meta) {
    const match = meta.path.match(this.fileGuidRegExp)
    return match ? match[1] : ''
  }

  /** 创建自动图块模板数据映射表 */
  createAutotileMap() {
    const autotiles = {}
    for (const item of this.autotiles) {
      autotiles[item.id] = item
    }
    this.autotiles = autotiles
  }

  /** 创建过渡映射表 */
  createEasingMap() {
    const easings = {}
    const keyRemap = {}
    for (const item of this.easings) {
      easings[item.id] = item
      keyRemap[item.id] = item.id
      if (item.key) {
        keyRemap[item.key] = item.id
      }
    }
    easings.remap = keyRemap
    this.easings = easings
  }

  /**
   * 编译对象中的事件
   * @param {Object} data 对象数据
   * @param {string} eventPath 事件路径
   * @returns {Object} 事件集合
   */
  compileEvents(data, eventPath) {
    const typeMap = {}
    for (const event of data.events) {
      let eventName
      let eventType
      const enumItem = Enum.get(event.type)
      if (enumItem) {
        eventName = enumItem.name
        eventType = enumItem.value
      } else {
        eventName = event.type
        eventType = event.type
      }
      event.commands.path = `@ ${eventPath}\n@ ${eventName}`
      typeMap[eventType] = Command.compile(event.commands)
    }
    return data.events = typeMap
  }

  /**
   * 保存游戏数据到文件
   * @param {string} number 存档编号
   * @param {Object} meta 存档元数据(时间、地点、截图等附加数据)
   * @returns {Promise&lt;undefined>}
   */
  saveGameData(number, meta) {
    const suffix = number.toString().padStart(2, '0')
    const data = {
      playTime: Time.playTime,
      actors: ActorManager.saveData(),
      party: Party.saveData(),
      team: Team.saveData(),
      scene: Scene.saveData(),
      camera: Camera.saveData(),
      variables: Variable.saveData(0),
      selfVariables: SelfVariable.saveData(),
    }
    // MacOS打包缺少写入权限，暂时改成web模式
    let shell = Stats.shell
    if (!Stats.debug &amp;&amp; Stats.isMacOS()) {
      shell = 'web'
    }
    switch (shell) {
      case 'electron': {
        const saveDir = File.route('Save')
        const metaPath = File.route(`Save/save${suffix}.meta`)
        const dataPath = File.route(`Save/save${suffix}.save`)
        const metaText = JSON.stringify(meta, null, 2)
        const dataText = JSON.stringify(data, null, 2)
        const fsp = require('fs').promises
        return fsp.stat(saveDir).catch(error => {
          // 如果不存在存档文件夹，创建它
          return fsp.mkdir('Save')
        }).then(() => Promise.all([
          // 异步写入元数据和存档数据
          fsp.writeFile(metaPath, metaText).catch(error => {console.warn(error)}),
          fsp.writeFile(dataPath, dataText).catch(error => {console.warn(error)}),
        ]))
      }
      case 'web': {
        const metaKey = `save${suffix}.meta`
        const dataKey = `save${suffix}.save`
        return Promise.all([
          IDB.setItem(metaKey, meta),
          IDB.setItem(dataKey, data),
        ])
      }
    }
  }

  /**
   * 从文件中加载游戏数据
   * @param {string} number 存档编号
   * @returns {Promise&lt;undefined>}
   */
  async loadGameData(number) {
    const suffix = number.toString().padStart(2, '0')
    let data
    let shell = Stats.shell
    if (!Stats.debug &amp;&amp; Stats.isMacOS()) {
      shell = 'web'
    }
    switch (shell) {
      case 'electron':
        // 推迟到栈尾执行
        await void 0
        try {
          // 同步读取存档数据文件
          const path = File.route(`Save/save${suffix}.save`)
          const json = require('fs').readFileSync(path)
          data = JSON.parse(json)
        } catch (error) {
          console.warn(error)
          return
        }
        break
      case 'web': {
        const key = `save${suffix}.save`
        data = await IDB.getItem(key)
        break
      }
    }
    Game.reset()
    Time.playTime = data.playTime
    ActorManager.loadData(data.actors)
    Party.loadData(data.party)
    Team.loadData(data.team)
    Scene.loadData(data.scene)
    Camera.loadData(data.camera)
    Variable.loadData(0, data.variables)
    SelfVariable.loadData(data.selfVariables)
    EventManager.callSpecialEvent('loadGame')
  }

  /**
   * 加载存档元数据列表
   * @returns {Promise&lt;Object[]>}
   */
  async loadSaveMeta() {
    const filenames = []
    const promises = []
    const metaname = /^save\d{2}\.meta$/
    const extname = /\.meta$/
    let shell = Stats.shell
    if (!Stats.debug &amp;&amp; Stats.isMacOS()) {
      shell = 'web'
    }
    switch (shell) {
      case 'electron': {
        const saveDir = File.route('Save')
        const fsp = require('fs').promises
        // 如果不存在存档文件夹，获取空文件列表
        const files = await fsp.readdir(
          saveDir, {withFileTypes: true},
        ).catch(error => [])
        for (const file of files) {
          // 获取所有的meta文件名
          if (file.isFile() &amp;&amp; metaname.test(file.name)) {
            filenames.push(file.name)
          }
        }
        // 加载所有meta文件
        for (const filename of filenames) {
          promises.push(File.get({
            path: `Save/${filename}`,
            type: 'json',
          }))
        }
        break
      }
      case 'web':
        for (const key of await IDB.getKeys()) {
          if (metaname.test(key)) {
            filenames.push(key)
          }
        }
        for (const filename of filenames.sort()) {
          promises.push(IDB.getItem(filename))
        }
        break
    }
    return Promise.all(promises).then(data => {
      const list = []
      const length = data.length
      for (let i = 0; i &lt; length; i++) {
        // 如果meta数据有效，添加到列表中返回
        if (data[i]) {
          const name = filenames[i].replace(extname, '')
          const index = parseInt(name.slice(-2))
          list.push({
            index: index,
            name: name,
            data: data[i],
          })
        }
      }
      return list
    })
  }

  /**
   * 删除游戏数据存档文件
   * @param {string} number 存档编号
   * @returns {Promise&lt;undefined>}
   */
  deleteGameData(number) {
    const suffix = number.toString().padStart(2, '0')
    let shell = Stats.shell
    if (!Stats.debug &amp;&amp; Stats.isMacOS()) {
      shell = 'web'
    }
    switch (shell) {
      case 'electron': {
        const metaPath = File.route(`Save/save${suffix}.meta`)
        const dataPath = File.route(`Save/save${suffix}.save`)
        const fsp = require('fs').promises
        return Promise.all([
          // 异步删除元数据和存档数据
          fsp.unlink(metaPath).catch(error => {console.warn(error)}),
          fsp.unlink(dataPath).catch(error => {console.warn(error)}),
        ])
      }
      case 'web': {
        const metaKey = `save${suffix}.meta`
        const dataKey = `save${suffix}.save`
        return Promise.all([
          IDB.removeItem(metaKey),
          IDB.removeItem(dataKey),
        ])
      }
    }
  }

  /**
   * 保存全局数据到文件
   * @returns {Promise&lt;undefined>}
   */
  saveGlobalData() {
    const data = {
      language: Local.language,
      variables: Variable.saveData(1),
    }
    let shell = Stats.shell
    if (!Stats.debug &amp;&amp; Stats.isMacOS()) {
      shell = 'web'
    }
    switch (shell) {
      case 'electron': {
        const saveDir = File.route('Save')
        const path = File.route('Save/global.save')
        const json = JSON.stringify(data, null, 2)
        const fs = require('fs')
        // 如果不存在存档文件夹，创建它
        if (!fs.existsSync(saveDir)) {
          fs.mkdirSync(saveDir)
        }
        // 异步写入全局数据文件
        return fs.writeFileSync(path, json)
      }
      case 'web': {
        const key = 'global.save'
        return IDB.setItem(key, data)
      }
    }
  }

  /**
   * 从文件中加载全局数据
   * @returns {Promise&lt;undefined>}
   */
  async loadGlobalData() {
    Game.on('ready', () => {
      delete Data.globalData
    })
    let shell = Stats.shell
    if (!Stats.debug &amp;&amp; Stats.isMacOS()) {
      shell = 'web'
    }
    switch (shell) {
      case 'electron':
        try {
          const path = File.route('Save/global.save')
          const fsp = require('fs').promises
          const json = await fsp.readFile(path)
          this.globalData = JSON.parse(json)
        } catch (error) {
          this.globalData = {
            language: Data.config.localization.default,
            variables: {},
          }
        }
        break
      case 'web': {
        const key = 'global.save'
        const data = await IDB.getItem(key)
        this.globalData = data ?? {
          language: Data.config.localization.default,
          variables: {},
        }
        break
      }
    }
  }
}

// ******************************** 索引数据库封装对象 ********************************

const IDB = new class {
  // 数据库Promise
  promise

  /**
   * 打开数据库
   * @returns {Promise&lt;IDBObjectStore>}
   */
  open() {
    if (!this.promise) {
      // localStorage数据容量有限，indexedDB可以存放大量数据
      const dbName = 'yami-rpg:' + Data.config.gameId
      const request = indexedDB.open(dbName)
      request.onupgradeneeded = event => {
        const db = event.target.result
        db.createObjectStore('game-data', {keyPath: 'key'})
      }
      this.promise = new Promise(resolve => {
        request.onsuccess = event => {
          resolve(event.target.result)
        }
      })
    }
    return this.promise.then(db => {
      const transaction = db.transaction(['game-data'], 'readwrite')
      return transaction.objectStore('game-data')
    })
  }

  /**
   * 获取所有数据键(游戏存档文件名)
   * @returns {Promise&lt;string[]>} 键列表
   */
  getKeys() {
    return new Promise(resolve => {
      this.open().then(objectStore => {
        const request = objectStore.getAllKeys()
        request.onsuccess = event => {
          resolve(event.target.result)
        }
      })
    })
  }

  /**
   * 获取数据内容
   * @param {string} key 键(存档文件名)
   * @returns {Promise&lt;any>} 读取的数据
   */
  getItem(key) {
    return new Promise(resolve => {
      this.open().then(objectStore => {
        const request = objectStore.get(key)
        request.onsuccess = event => {
          resolve(event.target.result?.value)
        }
      })
    })
  }

  /**
   * 设置数据内容
   * @param {string} key 键(存档文件名)
   * @param {any} value 写入的数据
   * @returns {Promise&lt;undefined>}
   */
  setItem(key, value) {
    return new Promise(resolve => {
      this.open().then(objectStore => {
        const request = objectStore.put({key, value})
        request.onsuccess = event => {
          resolve()
        }
      })
    })
  }

  /**
   * 移除数据内容
   * @param {string} key 键(存档文件名)
   * @returns {Promise&lt;undefined>}
   */
  removeItem(key) {
    return new Promise(resolve => {
      this.open().then(objectStore => {
        const request = objectStore.delete(key)
        request.onsuccess = event => {
          resolve()
        }
      })
    })
  }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Actor.html">Actor</a></li><li><a href="ActorCollider.html">ActorCollider</a></li><li><a href="ActorNavigator.html">ActorNavigator</a></li><li><a href="Animation.html">Animation</a></li><li><a href="AnimationController.html">AnimationController</a></li><li><a href="AudioPlayer.html">AudioPlayer</a></li><li><a href="AudioReverb.html">AudioReverb</a></li><li><a href="BatchRenderer.html">BatchRenderer</a></li><li><a href="CooldownItem.html">CooldownItem</a></li><li><a href="CooldownManager.html">CooldownManager</a></li><li><a href="DialogBoxElement.html">DialogBoxElement</a></li><li><a href="EasingMap.html">EasingMap</a></li><li><a href="Equipment.html">Equipment</a></li><li><a href="EquipmentManager.html">EquipmentManager</a></li><li><a href="EventHandler.html">EventHandler</a></li><li><a href="ImageElement.html">ImageElement</a></li><li><a href="ImageTexture.html">ImageTexture</a></li><li><a href="Inventory.html">Inventory</a></li><li><a href="Item.html">Item</a></li><li><a href="Matrix.html">Matrix</a></li><li><a href="MultipleAudioPlayer.html">MultipleAudioPlayer</a></li><li><a href="ParticleElement.html">ParticleElement</a></li><li><a href="ParticleEmitter.html">ParticleEmitter</a></li><li><a href="ParticleLayer.html">ParticleLayer</a></li><li><a href="Printer.html">Printer</a></li><li><a href="ProgressBarElement.html">ProgressBarElement</a></li><li><a href="SceneActorList.html">SceneActorList</a></li><li><a href="SceneAnimation.html">SceneAnimation</a></li><li><a href="SceneAnimationList.html">SceneAnimationList</a></li><li><a href="SceneContext.html">SceneContext</a></li><li><a href="SceneGridCellList.html">SceneGridCellList</a></li><li><a href="SceneLight.html">SceneLight</a></li><li><a href="SceneLightManager.html">SceneLightManager</a></li><li><a href="SceneObstacleArray.html">SceneObstacleArray</a></li><li><a href="SceneParallax.html">SceneParallax</a></li><li><a href="SceneParallaxManager.html">SceneParallaxManager</a></li><li><a href="SceneParticleEmitter.html">SceneParticleEmitter</a></li><li><a href="SceneParticleEmitterList.html">SceneParticleEmitterList</a></li><li><a href="SceneRegion.html">SceneRegion</a></li><li><a href="SceneRegionList.html">SceneRegionList</a></li><li><a href="SceneSpriteRenderer.html">SceneSpriteRenderer</a></li><li><a href="SceneTerrainArray.html">SceneTerrainArray</a></li><li><a href="SceneTilemap.html">SceneTilemap</a></li><li><a href="SceneTriggerList.html">SceneTriggerList</a></li><li><a href="Script.html">Script</a></li><li><a href="Shortcut.html">Shortcut</a></li><li><a href="Skill.html">Skill</a></li><li><a href="SkillCooldownList.html">SkillCooldownList</a></li><li><a href="SkillManager.html">SkillManager</a></li><li><a href="State.html">State</a></li><li><a href="StateCountdownList.html">StateCountdownList</a></li><li><a href="StateManager.html">StateManager</a></li><li><a href="TargetManager.html">TargetManager</a></li><li><a href="TextBoxElement.html">TextBoxElement</a></li><li><a href="TextElement.html">TextElement</a></li><li><a href="Texture.html">Texture</a></li><li><a href="TextureManager.html">TextureManager</a></li><li><a href="Timer.html">Timer</a></li><li><a href="Trigger.html">Trigger</a></li><li><a href="UIElement.html">UIElement</a></li><li><a href="VideoElement.html">VideoElement</a></li><li><a href="WindowElement.html">WindowElement</a></li></ul><h3>Global</h3><ul><li><a href="global.html#GL">GL</a></li><li><a href="global.html#_createElement">_createElement</a></li><li><a href="global.html#_updateBubbleState">_updateBubbleState</a></li><li><a href="global.html#activate">activate</a></li><li><a href="global.html#add">add</a></li><li><a href="global.html#addMember">addMember</a></li><li><a href="global.html#addPointerEventRoot">addPointerEventRoot</a></li><li><a href="global.html#append">append</a></li><li><a href="global.html#autorun">autorun</a></li><li><a href="global.html#bind">bind</a></li><li><a href="global.html#buildPath">buildPath</a></li><li><a href="global.html#calculateCoords">calculateCoords</a></li><li><a href="global.html#calculateSceneCoords">calculateSceneCoords</a></li><li><a href="global.html#call">call</a></li><li><a href="global.html#callAutorunEvents">callAutorunEvents</a></li><li><a href="global.html#callSpecialEvent">callSpecialEvent</a></li><li><a href="global.html#changeRelation">changeRelation</a></li><li><a href="global.html#checkIfRemovedHover">checkIfRemovedHover</a></li><li><a href="global.html#clearGlobalActors">clearGlobalActors</a></li><li><a href="global.html#compileEvents">compileEvents</a></li><li><a href="global.html#continue">continue</a></li><li><a href="global.html#convertToScreenCoords">convertToScreenCoords</a></li><li><a href="global.html#create">create</a></li><li><a href="global.html#createAutotileMap">createAutotileMap</a></li><li><a href="global.html#createEasingMap">createEasingMap</a></li><li><a href="global.html#createElement">createElement</a></li><li><a href="global.html#createFollower">createFollower</a></li><li><a href="global.html#createMembers">createMembers</a></li><li><a href="global.html#createPath">createPath</a></li><li><a href="global.html#createPlayer">createPlayer</a></li><li><a href="global.html#createUnitPath">createUnitPath</a></li><li><a href="global.html#decodeClone">decodeClone</a></li><li><a href="global.html#decodeTeamData">decodeTeamData</a></li><li><a href="global.html#decodeTerrains">decodeTerrains</a></li><li><a href="global.html#decodeTiles">decodeTiles</a></li><li><a href="global.html#delete">delete</a></li><li><a href="global.html#deleteGameData">deleteGameData</a></li><li><a href="global.html#disable">disable</a></li><li><a href="global.html#displayErrorMessage">displayErrorMessage</a></li><li><a href="global.html#doubleclick">doubleclick</a></li><li><a href="global.html#emit">emit</a></li><li><a href="global.html#emitInputEvent">emitInputEvent</a></li><li><a href="global.html#enable">enable</a></li><li><a href="global.html#encodeTeamData">encodeTeamData</a></li><li><a href="global.html#encodeTerrains">encodeTerrains</a></li><li><a href="global.html#executeCallbacks">executeCallbacks</a></li><li><a href="global.html#find">find</a></li><li><a href="global.html#follow">follow</a></li><li><a href="global.html#gamepadbuttonpress">gamepadbuttonpress</a></li><li><a href="global.html#gamepadbuttonrelease">gamepadbuttonrelease</a></li><li><a href="global.html#gamepadleftstickchange">gamepadleftstickchange</a></li><li><a href="global.html#gamepadrightstickchange">gamepadrightstickchange</a></li><li><a href="global.html#generate32bit">generate32bit</a></li><li><a href="global.html#generate64bit">generate64bit</a></li><li><a href="global.html#get">get</a></li><li><a href="global.html#getElementAtMouse">getElementAtMouse</a></li><li><a href="global.html#getGroup">getGroup</a></li><li><a href="global.html#getItem">getItem</a></li><li><a href="global.html#getKey">getKey</a></li><li><a href="global.html#getKeys">getKeys</a></li><li><a href="global.html#getName">getName</a></li><li><a href="global.html#getParallaxAnchor">getParallaxAnchor</a></li><li><a href="global.html#getPathByGUID">getPathByGUID</a></li><li><a href="global.html#getPointerEventRoot">getPointerEventRoot</a></li><li><a href="global.html#getRelationByIndexes">getRelationByIndexes</a></li><li><a href="global.html#getValue">getValue</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#isEnemy">isEnemy</a></li><li><a href="global.html#isFriendly">isFriendly</a></li><li><a href="global.html#isMacOS">isMacOS</a></li><li><a href="global.html#keydown">keydown</a></li><li><a href="global.html#keydownFilter">keydownFilter</a></li><li><a href="global.html#keyup">keyup</a></li><li><a href="global.html#load">load</a></li><li><a href="global.html#loadData">loadData</a></li><li><a href="global.html#loadFile">loadFile</a></li><li><a href="global.html#loadGameData">loadGameData</a></li><li><a href="global.html#loadGlobalData">loadGlobalData</a></li><li><a href="global.html#loadMeta">loadMeta</a></li><li><a href="global.html#loadObjects">loadObjects</a></li><li><a href="global.html#loadPresets">loadPresets</a></li><li><a href="global.html#loadSaveMeta">loadSaveMeta</a></li><li><a href="global.html#loadScene">loadScene</a></li><li><a href="global.html#loadScripts">loadScripts</a></li><li><a href="global.html#loadUI">loadUI</a></li><li><a href="global.html#mousedown">mousedown</a></li><li><a href="global.html#mousedownLB">mousedownLB</a></li><li><a href="global.html#mousedownRB">mousedownRB</a></li><li><a href="global.html#mouseleave">mouseleave</a></li><li><a href="global.html#mousemove">mousemove</a></li><li><a href="global.html#mouseup">mouseup</a></li><li><a href="global.html#mouseupLB">mouseupLB</a></li><li><a href="global.html#mouseupRB">mouseupRB</a></li><li><a href="global.html#moveTo">moveTo</a></li><li><a href="global.html#off">off</a></li><li><a href="global.html#on">on</a></li><li><a href="global.html#onTransitionEnd">onTransitionEnd</a></li><li><a href="global.html#open">open</a></li><li><a href="global.html#parseCSSColor">parseCSSColor</a></li><li><a href="global.html#parseDateTimestamp">parseDateTimestamp</a></li><li><a href="global.html#parseFloatArray">parseFloatArray</a></li><li><a href="global.html#parseFloatArrayTag">parseFloatArrayTag</a></li><li><a href="global.html#parseGUID">parseGUID</a></li><li><a href="global.html#parseInt">parseInt</a></li><li><a href="global.html#parseIntArray">parseIntArray</a></li><li><a href="global.html#pause">pause</a></li><li><a href="global.html#pointerdown">pointerdown</a></li><li><a href="global.html#pointerenter">pointerenter</a></li><li><a href="global.html#pointerleave">pointerleave</a></li><li><a href="global.html#pointermove">pointermove</a></li><li><a href="global.html#pointerup">pointerup</a></li><li><a href="global.html#pop">pop</a></li><li><a href="global.html#precompile">precompile</a></li><li><a href="global.html#precompileActors">precompileActors</a></li><li><a href="global.html#precompileAnimations">precompileAnimations</a></li><li><a href="global.html#precompileEquipments">precompileEquipments</a></li><li><a href="global.html#precompileItems">precompileItems</a></li><li><a href="global.html#precompileSkills">precompileSkills</a></li><li><a href="global.html#precompileStates">precompileStates</a></li><li><a href="global.html#precompileTriggers">precompileTriggers</a></li><li><a href="global.html#preventInput">preventInput</a></li><li><a href="global.html#push">push</a></li><li><a href="global.html#remapScripts">remapScripts</a></li><li><a href="global.html#remove">remove</a></li><li><a href="global.html#removeItem">removeItem</a></li><li><a href="global.html#removeLatestPointerEventRoot">removeLatestPointerEventRoot</a></li><li><a href="global.html#removeMember">removeMember</a></li><li><a href="global.html#removePointerEventRoot">removePointerEventRoot</a></li><li><a href="global.html#render">render</a></li><li><a href="global.html#renderLoadingProgress">renderLoadingProgress</a></li><li><a href="global.html#reset">reset</a></li><li><a href="global.html#resetPointerEventRoots">resetPointerEventRoots</a></li><li><a href="global.html#resize">resize</a></li><li><a href="global.html#restoreInput">restoreInput</a></li><li><a href="global.html#rotateAndScaleCanvas">rotateAndScaleCanvas</a></li><li><a href="global.html#route">route</a></li><li><a href="global.html#saveData">saveData</a></li><li><a href="global.html#saveGameData">saveGameData</a></li><li><a href="global.html#saveGlobalData">saveGlobalData</a></li><li><a href="global.html#scaleCanvas">scaleCanvas</a></li><li><a href="global.html#set">set</a></li><li><a href="global.html#setBypass">setBypass</a></li><li><a href="global.html#setItem">setItem</a></li><li><a href="global.html#setPlayer">setPlayer</a></li><li><a href="global.html#setTimeScale">setTimeScale</a></li><li><a href="global.html#setToHighestPriority">setToHighestPriority</a></li><li><a href="global.html#setZoomFactor">setZoomFactor</a></li><li><a href="global.html#shake">shake</a></li><li><a href="global.html#shareInventory">shareInventory</a></li><li><a href="global.html#simulateKey">simulateKey</a></li><li><a href="global.html#start">start</a></li><li><a href="global.html#stop">stop</a></li><li><a href="global.html#switchGameInfoDisplay">switchGameInfoDisplay</a></li><li><a href="global.html#testConditions">testConditions</a></li><li><a href="global.html#unfollow">unfollow</a></li><li><a href="global.html#unpack">unpack</a></li><li><a href="global.html#unpackTeamData">unpackTeamData</a></li><li><a href="global.html#update">update</a></li><li><a href="global.html#updateLoadingProgress">updateLoadingProgress</a></li><li><a href="global.html#wheel">wheel</a></li><li><a href="global.html#xhr">xhr</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Mon Aug 21 2023 21:54:29 GMT+0800 (中国标准时间)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
